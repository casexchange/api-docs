---
title: "Evaluate Routing Rules"
description: "Ask CaseXchange which firm should receive a case"
---

<Endpoint method="POST" path="/api/v1/routing/evaluate-api" />

Evaluate routing rules to determine which firm should receive a case based on case characteristics. Use this endpoint for "preview" experiences before creating cases, or to validate routing logic.

## Authentication

<ParamField header="Authorization" type="string" required>
Bearer token obtained from login or OAuth flow. Format: `Bearer <token>`
</ParamField>

## Request Body

<ParamField body="severity" type="integer">
Case severity level. Range: 1-5. Higher values indicate more severe cases.
</ParamField>

<ParamField body="caseType" type="string" required>
Type of case. Use `/api/v1/firms/case-types` to get valid values. Example: `personal_injury`.
</ParamField>

<ParamField body="jurisdiction" type="string" required>
Jurisdiction code. Use `/api/v1/firms/jurisdictions/list` for valid codes. Example: `CA`.
</ParamField>

<RequestExample>
```bash cURL
curl -X POST 'https://api.casexchange.com/api/v1/routing/evaluate-api' \
  -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...' \
  -H 'Content-Type: application/json' \
  -d '{
    "severity": 3,
    "caseType": "personal_injury",
    "jurisdiction": "CA"
  }'
```
</RequestExample>

<RequestExample>
```javascript Node.js
const response = await fetch('https://api.casexchange.com/api/v1/routing/evaluate-api', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${accessToken}`,
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    severity: 3,
    caseType: 'personal_injury',
    jurisdiction: 'CA'
  })
});

const data = await response.json();
console.log('Routed to firm:', data.data.firm.name);
console.log('Rule:', data.data.rule.name);
```
</RequestExample>

## Response

<ResponseField name="success" type="boolean" required>
Indicates whether the routing evaluation succeeded.
</ResponseField>

<ResponseField name="data" type="object" required>
Routing evaluation result.

<Expandable title="Routing result properties">
<ResponseField name="firm" type="object" required>
Firm that would receive the case based on routing rules.

<Expandable title="Firm properties">
<ResponseField name="id" type="string" required>
Firm UUID.
</ResponseField>

<ResponseField name="name" type="string" required>
Firm's legal name.
</ResponseField>

<ResponseField name="contactEmail" type="string">
Primary contact email address.
</ResponseField>

<ResponseField name="contactPhone" type="string">
Primary contact phone number.
</ResponseField>

<ResponseField name="isExternalContact" type="boolean" required>
Whether this is an external contact point (not a registered firm user).
</ResponseField>
</Expandable>
</ResponseField>

<ResponseField name="isActive" type="boolean" required>
Whether the routing rule is currently active.
</ResponseField>

<ResponseField name="rule" type="object" required>
Routing rule that matched the case criteria.

<Expandable title="Rule properties">
<ResponseField name="id" type="string" required>
Rule UUID.
</ResponseField>

<ResponseField name="name" type="string" required>
Rule name or identifier.
</ResponseField>

<ResponseField name="description" type="string">
Rule description explaining the routing logic.
</ResponseField>
</Expandable>
</ResponseField>
</Expandable>
</ResponseField>

<ResponseExample>
```json Success (200 OK)
{
  "success": true,
  "data": {
    "firm": {
      "id": "f2b3c4d5-e6f7-8901-bcde-f12345678901",
      "name": "Johnson Legal Group",
      "contactEmail": "contact@johnsonlegal.com",
      "contactPhone": "+14155552345",
      "isExternalContact": false
    },
    "isActive": true,
    "rule": {
      "id": "r1a2b3c4-d5e6-7890-abcd-ef1234567890",
      "name": "CA Personal Injury - High Volume",
      "description": "Routes personal injury cases in California to Johnson Legal Group for high-volume handling"
    }
  }
}
```
</ResponseExample>

<ResponseExample>
```json Error - No Rule Matches (404 Not Found)
{
  "success": false,
  "error": {
    "code": "resource_not_found",
    "message": "No routing rule matches the provided criteria",
    "details": {
      "caseType": "personal_injury",
      "jurisdiction": "CA",
      "severity": 3
    }
  }
}
```
</ResponseExample>

## Example: Preview Routing Before Creating Case

```javascript Node.js
async function previewRouting(caseData, accessToken) {
  const response = await fetch('https://api.casexchange.com/api/v1/routing/evaluate-api', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${accessToken}`,
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      severity: caseData.severity,
      caseType: caseData.caseType,
      jurisdiction: caseData.jurisdiction
    })
  });

  if (!response.ok) {
    const error = await response.json();
    
    if (response.status === 404) {
      return {
        routed: false,
        message: 'No routing rule matches. You may need to manually select a firm.'
      };
    } else {
      throw new Error(error.error?.message || 'Routing evaluation failed');
    }
  }

  const { data } = await response.json();
  return {
    routed: true,
    firm: data.firm,
    rule: data.rule,
    isActive: data.isActive
  };
}

const caseData = {
  severity: 3,
  caseType: 'personal_injury',
  jurisdiction: 'CA'
};

const routing = await previewRouting(caseData, accessToken);

if (routing.routed) {
  console.log(`Case will be routed to: ${routing.firm.name}`);
  console.log(`Rule: ${routing.rule.name}`);
  console.log(`Contact: ${routing.firm.contactEmail}`);
} else {
  console.log(routing.message);
}
```

<Note>
Evaluation runs within the caller's firm context (derived from the JWT). Routing rules are evaluated based on your firm's configured routing logic. If no rule matches, expect a `resource_not_found` error.
</Note>

<Tip>
Use this endpoint for "preview" experiences before creating cases. This allows users to see which firm will receive their case before submitting it, improving transparency and user experience.
</Tip>

